---
import Writing from "@/content/writing.mdx";
import { getCollection } from "astro:content";
import MainLayout from "@/layouts/mainLayout.astro";
import ContentHeader from "@/components/ContentHeader.astro";
import { formateDate, sortPosts, type Post } from "@/lib/utils";

const posts: Post[] = await getCollection("writing");
const sortedPosts = sortPosts(posts);
---

<MainLayout title="writing" enableProse={false}>
  <ContentHeader slot="header" title="Writing">
    welcome to my blog
  </ContentHeader>

  <ul class="!mt-5 flex flex-col gap-6 !p-0">
    {
      sortedPosts.map((post) => {
        const { title, date, description } = post.data;

        const isoStringDate = date ? date.toISOString() : null;
        const formattedDate = date ? formateDate(date) : "Date not available";

        return (
          <li>
            <article class="flex flex-col gap-1">
              <div class="flex flex-col items-start justify-between gap-1 sm:flex-row sm:gap-2">
                <h3 class="text-xl  font-medium">
                  <a href={`/writing/${post.slug}`}>{title}</a>
                </h3>
              </div>
              <div class="text-muted-foreground">
                <span>{description}</span>
                <span>â€¢</span>
                <span class="text-sm lowercase">
                  <time dateTime={isoStringDate}>{formattedDate}</time>
                </span>
              </div>
            </article>
          </li>
        );
      })
    }
  </ul>
</MainLayout>
