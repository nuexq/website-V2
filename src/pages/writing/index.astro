---
import Writing from "@/content/writing.mdx";
import { getCollection } from "astro:content";
import MainLayout from "@/layouts/mainLayout.astro";
import { formateDate, sortPosts, type Post } from "@/lib/utils";

const posts: Post[] = await getCollection("writing");
const sortedPosts = sortPosts(posts);
---

<MainLayout title="writing">
  <Writing />
  <ul class="!mt-5 flex flex-col gap-6 !p-0">
    {
      sortedPosts.map((post) => {
        const { title, date, description } = post.data;

        const isoStringDate = date ? date.toISOString() : null;
        const formattedDate = date ? formateDate(date) : "Date not available";

        return (
          <li class="list-none gap-1 !p-0">
            <article class="flex flex-col gap-1">
              <div class="flex flex-col items-start justify-between gap-1 sm:flex-row sm:gap-2">
                <h3 class="!border-b-0 !font-body">
                  <a href={`/writing/${post.slug}`}>{title}</a>
                </h3>
                <div class="text-sm">
                  <time dateTime={isoStringDate}>{formattedDate}</time>
                </div>
              </div>
              <p class="!mt-0 !text-muted-foreground">{description}</p>
            </article>
          </li>
        );
      })
    }
  </ul>
</MainLayout>
